{% extends 'dashboard/base.html' %}

{% block title %}
Summoner Stats, Find Allies, Message Friends - {{ block.super }}
{% endblock title %}

{% block content %}
  <div id="errors">
    <transition name="fade">
      <div class="error-wrapper" v-if="isError" v-cloak>
        <div class="alert">
          <span><i class="fas fa-exclamation-triangle"></i> [[ errorMessage ]]</span>
        </div>
      </div>
    </transition>
  </div>
  <div id="summoners" v-bind:class="{ error: isError }">
    <h1>Summoners</h1>
    {% if user.is_authenticated %}
      <div class="actions">
        <input type="text" value="" v-model="addSummonerName" />
        <button v-on:click="addSummoner">Add Summoner</button>
        <span v-if="ajaxRequest" v-cloak>Please Wait ...</span>
      </div>
    {% endif %}
    <div class="panels">
      <div class="topPlayers panel">
        <div class="summoners_loader loader" v-if="topPlayersLoading">
          <div class="half-circle-spinner">
            <div class="circle circle-1"></div>
            <div class="circle circle-2"></div>
          </div>
        </div>
        <h2 v-if="!topPlayersLoading" v-cloak>Top 100 Players</h2>
        <transition name="fade">
          <table v-if="!topPlayersLoading" v-cloak>
            <tr>
              <th scope="col">Summoner Name</th>
              <th scope="col">Tier</th>
              <th scope="col">Wins</th>
              <th scope="col">Losses</th>
              <th scope="col">League Points</th>
            </tr>
            <tr v-for="summoner in topPlayers">
              <th scope="row"><a :href="summoner.summonerName">[[ summoner.summonerName ]]</a></th>
              <td>[[ summoner.rankedSolo.tier ]] [[ summoner.rankedSolo.rank ]]</td>
              <td>[[ summoner.rankedSolo.wins ]]</td>
              <td>[[ summoner.rankedSolo.losses ]]</td>
              <td>[[ summoner.rankedSolo.lp ]]</td>
            </tr>
          </table>
        </transition>
      </div>
      <div class="latestPlayers panel">
        <div class="summoners_loader loader" v-if="latestPlayersLoading">
          <div class="half-circle-spinner">
            <div class="circle circle-1"></div>
            <div class="circle circle-2"></div>
          </div>
        </div>
        <h2 v-if="!latestPlayersLoading" v-cloak>Latest Updated Players</h2>
        <transition name="fade">
          <table v-if="!latestPlayersLoading" v-cloak>
            <tr>
              <th scope="col">Summoner Name</th>
              <th scope="col">Last Updated</th>
            </tr>
            <tr v-for="summoner in latestPlayers">
              <th scope="row"><a :href="summoner.summonerName">[[ summoner.summonerName ]]</a></th>
              <td>[[ summoner.lastUpdated ]]</td>
            </tr>
          </table>
        </transition>
      </div>
    </div>
  </div>

<script>
    $(document).ready(
        errorHandling(),
        onSummonerListLoad()
    )
</script>
{% endblock content %}
